function Test-CVE-2020-0610
{   
    [CmdletBinding()]
    param(
        [Parameter()]
        [string] $ComputerName
    )

    # Ref : https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0610
    $RequiredUpdate = @(
        # 2012
        'KB4534283'
        'KB4534288'
        # 2012 R2
        'KB4534297'
        'KB4534309'
        # 2016
        'KB4534271'
        # 2019
        'KB4534273'
    )

    $ScriptBlock = {
        # WMI
        Get-Hotfix | Foreach-Object {
            [PSCustomObject] @{
                ID          = $_.HotfixID
                InstalledOn = $_.InstalledOn
            }
        }

        # Windows Update

        $ComObject = New-Object -ComObject "Microsoft.Update.Session"

        $Searcher = $ComObject.CreateUpdateSearcher()
        $HistoryCount = $Searcher.GetTotalHistoryCount()

        $Searcher.QueryHistory(0, $HistoryCount) | ForEach-Object {
            $_.Title -match "KB\d+" | Out-Null

            [PSCustomObject] @{
                ID = $Matches[0]
                InstalledOn = $_.Date
            }
        }
    }

    $InstalledUpdates = if("" -eq $ComputerName)
    {
        &$ScriptBlock
    }
    else
    {
        Invoke-Command -ComputerName $ComputerName -ScriptBlock $ScriptBlock
    }

    if($null -ne ($InstalledUpdates | Where-Object { $_.ID -in $RequiredUpdate })) { Write-Host "Patched" -ForegroundColor Green }
    else { Write-Host "Vulnerable" -ForegroundColor Red }
}